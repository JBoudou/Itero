<form [formGroup]="form">
  <div class="alternatives-list" formArrayName="Alternatives">
    <div *ngFor="let alt of Alternatives.controls; index as i" [formGroupName]="i"
    class="merged-userbox-grow alternative"
    [@deleteTrigger]="justDeleted == i ? 'justDeleted' : 'Ok'" (@deleteTrigger.done)="onDeleteDone()">
      <input type="text" formControlName="Name" />
      <button type="button" (click)="onDelete(i)"><mat-icon>delete</mat-icon></button>
    </div>
  </div>
  <mat-form-field class="new-alternative" appearance="standard">
    <mat-label i18n>New alternative</mat-label>
    <input matInput type="text" formControlName="New" [errorStateMatcher]="errorStateMatcher" (keyup.enter)="onAdd()" />
    <button mat-icon-button matSuffix type="button" (click)="onAdd()" [disabled]="!form.get('New').valid" i18n><mat-icon>add</mat-icon></button>
  </mat-form-field>
</form>
<div class="formerrors" *ngIf="!(validable$ | async)">
  <p *ngIf="newIsDuplicate()" i18n>
    There already is an alternative with the same name.
  </p>
  <p *ngIf="hasDuplicate()" i18n>
    There are alternatives with the same name.
  </p>
  <p *ngIf="tooFewAlternatives()" i18n>
    You must add at least
    { Alternatives.length, plural, =0 {two alternatives} =1 { one more alternative} }
    to this poll.
  </p>
</div>

<ng-template #stepInfo let-query="query$">
  <ng-container *ngIf="query | async as q">
    <p>
      At each round, each participant will vote for one of the alternatives.
    </p>
  </ng-container>
</ng-template>
